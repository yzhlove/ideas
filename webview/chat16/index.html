<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta charset="utf-8"/>
    <title>文本点选式验证码</title>
    <link rel="icon"
          href="https://webusstatic.yo-star.com/misc/yostar-official-2024-h5/main/h5/assets/logo-534946b4.png">

    <!-- 加载style样式 -->
    <style>

        html {
            width: 100%;
            height: 100%;
            background-color: #16202f;
        }

        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            min-width: 300px;
            position: relative;
            overflow: hidden;
            font-family: "Arial", sans-serif;
        }

        .wg-cap-root {
            width: 100%;
            height: 100%;
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            flex-direction: column;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
        }

        .wg-cap-container {
            position: relative;
            width: 335px;
            padding-top: 230px;
            /*padding:250px 0;*/
            height: 30px;
            margin: auto;
        }

        .wg-cap-container.wg-cap-dialog__active .wg-cap-dialog {
            display: block;
        }

        @keyframes tinUpIn {
            0% {
                opacity: 0;
                transform: scale(1) translateY(-500%);
            }
            /*50% { opacity:1; transform:scale(1.1) translateY(0); }*/
            /*70% { opacity:1; transform:scale(1.1) translateY(0); }*/
            /*90% { opacity:1; transform:scale(1.1) translateY(0);  }*/
            60% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
            80% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        @-webkit-keyframes tinUpIn {
            0% {
                opacity: 0;
                transform: scale(1) translateY(-500%);
            }
            /*50% { opacity:1; transform:scale(1.1) translateY(0); }*/
            /*70% { opacity:1; transform:scale(1.1) translateY(0); }*/
            /*90% { opacity:1; transform:scale(1.1) translateY(0);  }*/
            60% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
            80% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .wg-cap-container.wg-cap-dialog__active .wg-cap-wrap {
            display: block;
            animation: tinUpIn 1s linear;
            -moz-animation: tinUpIn 1s linear;
            -webkit-animation: tinUpIn 1s linear;
            border-top: 6px solid #4e87ff;
            -webkit-border-radius: 6px;
            -moz-border-radius: 6px;
            border-radius: 6px;
        }

        .wg-cap-container .wg-cap-block {
            /*padding-top: 440px;*/
        }

        .wg-cap-dialog {
            position: fixed;
            z-index: 2000;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            display: none;
        }

        .wg-cap-wrap {
            position: absolute;
            bottom: -10px;
            z-index: 2001;
            display: none;


            padding: 18px;
            border: 1px solid rgba(206, 223, 254, 0.5);
            background: #ffffff;

            -webkit-border-radius: 8px;
            -moz-border-radius: 8px;
            border-radius: 8px;

            box-shadow: 0 0 20px rgba(100, 100, 100, 0.1);
            -webkit-box-shadow: 0 0 20px rgba(100, 100, 100, 0.1);
            -moz-box-shadow: 0 0 20px rgba(100, 100, 100, 0.1);

            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .wg-cap-wrap__header {
            height: 36px;
            width: 100%;
            font-size: 15px;

            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
        }

        .wg-cap-wrap__header span {
            padding-right: 5px;
        }

        .wg-cap-wrap__header span em {
            padding: 0 3px;
            font-weight: bold;
            color: #3e7cff;
            font-style: normal;
        }

        .wg-cap-wrap__header .wg-text-center {
            text-align: center !important;
        }

        .wg-cap-wrap__header .wg-cap-wrap__ico {
            flex: auto;
            text-align: right;
            white-space: nowrap;
        }

        .wg-cap-wrap__header .wg-cap-wrap__ico img {
            width: 24px;
            height: 24px;
            color: #34383e;
            margin: 0 5px;
            cursor: pointer;
        }

        .wg-cap-wrap__header .wg-cap-wrap__image {
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
            overflow: hidden;
            text-align: center;
            line-height: 1;
        }

        .wg-cap-wrap__header .wg-cap-wrap__thumb.wg-cap-wrap__hidden {
            display: none;
        }

        /* 拼图 */
        .wg-cap-wrap__header.slide_header {
            /*height: 35px !important;*/
            /*padding-bottom: 7px !important;*/
        }

        .wg-cap-wrap__header.slide_header span {
            flex: 1;
        }

        /*旋转*/
        .wg-cap-wrap__header.rotate_header {
            /*height: 40px !important;*/
        }

        .wg-cap-wrap__body {
            position: relative;
            width: 300px;
            height: 220px;
            margin-top: 10px;
            display: -webkit-box;
            display: -moz-box;
            display: -ms-flexbox;
            display: -webkit-flex;
            display: flex;
            background: #34383e;
            /*margin: auto;*/
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
            overflow: hidden;
        }

        /* 拼图 */
        .wg-cap-wrap__body .wg-cap-wrap__tile {
            position: absolute;
            z-index: 30;
            cursor: pointer;
        }

        .wg-cap-wrap__body .wg-cap-tile__picture {
            cursor: pointer;
            width: 100%;
            height: 100%;
        }

        .wg-cap-wrap__body .wg-cap-wrap__picture {
            position: relative;
            z-index: 10;
            width: 100%;
            /*height: 240px;*/
            /*max-width: 100%;*/
            /*max-height: 100%;*/
            /*object-fit: cover;*/
            /*line-height: 240px;*/
            /*text-align: center;*/
        }

        .wg-cap-wrap__body .wg-cap-wrap__picture.wg-cap-wrap__hidden {
            display: none;
        }

        .wg-cap-wrap__body .wg-cap-wrap__loading {
            position: absolute;
            z-index: 9;
            top: 50%;
            left: 50%;
            width: 68px;
            height: 68px;
            margin-left: -34px;
            margin-top: -34px;
            line-height: 68px;
            text-align: center;
        }

        /* 点击 */
        .wg-cap-wrap__body.click_body .wg-cap-wrap__dots {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }

        .wg-cap-wrap__body.click_body .wg-cap-wrap__dot {
            position: absolute;
            z-index: 10;
            width: 22px;
            height: 22px;
            color: #cedffe;
            background: #3e7cff;
            border: 2px solid #f7f9fb;
            line-height: 22px;
            text-align: center;
            -webkit-border-radius: 22px;
            -moz-border-radius: 22px;
            border-radius: 22px;
            cursor: default;
            font-weight: 600;
        }

        /*旋转*/
        .wg-cap-wrap__body.rotate_body {
            background: transparent !important;
            display: -webkit-box;
            display: -moz-box;
            display: -ms-flexbox;
            display: -webkit-flex;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .wg-cap-wrap__body.rotate_body .wg-cap-wrap__pictureblock {
            position: relative;
            max-width: 100%;
            max-height: 100%;
            z-index: 10;
            border-radius: 100%;
            overflow: hidden;
        }

        .wg-cap-wrap__body.rotate_body .wg-cap-wrap__picture {
            max-width: 100%;
            max-height: 100%;
        }

        .wg-cap-wrap__body.rotate_body .wg-cap-wrap__pictureround {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 100%;
            z-index: 20;
            border: 6px solid #e0e0e0;
        }

        .wg-cap-wrap__body.rotate_body .wg-cap-wrap__thumb {
            position: absolute;
            z-index: 30;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }

        .wg-cap-wrap__body.rotate_body .wg-cap-wrap__thumb img {
            max-width: 100%;
            max-height: 100%;
        }

        .wg-cap-wrap__body.rotate_body .wg-cap-wrap__thumbblock {
            width: 100%;
            height: 100%;
            display: -webkit-box;
            display: -moz-box;
            display: -ms-flexbox;
            display: -webkit-flex;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .wg-cap-wrap__footer {
            width: 100%;
            height: 50px;
            color: #34383e;
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
            padding-top: 10px;
        }

        .wg-cap-wrap__footer .wg-cap-wrap__ico {
            flex: 1;
        }

        .wg-cap-wrap__footer .wg-cap-wrap__ico img {
            width: 24px;
            height: 24px;
            color: #34383e;
            margin: 0 5px;
            cursor: pointer;
        }

        .wg-cap-wrap__footer .wg-cap-wrap__btn {
            width: 120px;
            height: 40px;
        }

        .wg-cap-wrap__footer .wg-cap-wrap__btn button {
            width: 100%;
            height: 40px;
            letter-spacing: 2px;
            text-align: center;
            padding: 9px 15px;
            font-size: 15px;
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
            display: inline-block;
            line-height: 1;
            white-space: nowrap;
            cursor: pointer;
            color: #fff;
            background-color: #4e87ff;
            border: 1px solid #4e87ff;
            -webkit-appearance: none;
            box-sizing: border-box;
            outline: none;
            margin: 0;
            transition: .1s;
            font-weight: 500;
            -moz-user-select: none;
            -webkit-user-select: none;
        }

        .wg-cap-wrap__footer .wg-cap-wrap__btn button:hover {
            background: #66b1ff;
            border-color: #66b1ff;
            color: #fff;
        }

        /*拖拽*/
        .wg-cap-wrap__footer .wg-cap-wrap__drag_block {
            position: absolute;
            left: 0;
            top: 50%;
            margin-top: -24px;
            width: 82px;
            height: 48px;
            z-index: 10;
            background: #3e7cff;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;

            -webkit-border-radius: 24px;
            -moz-border-radius: 24px;
            border-radius: 24px;

            box-shadow: 0 0 20px rgba(100, 100, 100, 0.35);
            -webkit-box-shadow: 0 0 20px rgba(100, 100, 100, 0.35);
            -moz-box-shadow: 0 0 20px rgba(100, 100, 100, 0.35);
        }

        .wg-cap-wrap__footer .wg-cap-wrap__drag_slidebar {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .wg-cap-wrap__footer .wg-cap-wrap__drag_bar {
            position: absolute;
            height: 14px;
            background: #e0e0e0;
            left: 0;
            right: 0;
            top: 50%;
            margin-top: -7px;
            -webkit-border-radius: 7px;
            -moz-border-radius: 7px;
            border-radius: 7px;
        }

        .wg-cap-wrap__footer .wg-cap-wrap__drag_block img {
            width: 20px;
            height: 20px;
            color: #34383e;
            cursor: pointer;
        }

        .wg-cap-btn {
            width: 100%;
            height: 48px;
        }

        .wg-cap-btn .wg-cap-btn__inner {
            width: 100%;
            height: 48px;
            position: relative;
            letter-spacing: 1px;
        }

        .wg-cap-btn .wg-cap-state__default, .wg-cap-btn .wg-cap-state__error, .wg-cap-btn .wg-cap-state__success, .wg-cap-btn .wg-cap-state__over {
            position: absolute;
            width: 100%;
            height: 48px;
            font-size: 13px;
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
            display: inline-block;
            line-height: 1;
            white-space: nowrap;
            cursor: pointer;
            -webkit-appearance: none;
            box-sizing: border-box;
            outline: none;
            margin: 0;
            transition: .1s;
            font-weight: 500;
            -moz-user-select: none;
            -webkit-user-select: none;

            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
            justify-content: center;
            justify-items: center;

            visibility: hidden;
        }

        .wg-cap-btn .wg-cap-state__default {
            color: #3e7cff;
            border: 1px solid #50a1ff;
            background: #ecf5ff;
            box-shadow: 0 0 20px rgba(62, 124, 255, 0.1);
            -webkit-box-shadow: 0 0 20px rgba(62, 124, 255, 0.1);
            -moz-box-shadow: 0 0 20px rgba(62, 124, 255, 0.1);
        }

        .wg-cap-btn .wg-cap-state__error {
            color: #ed4630;
            background: #fef0f0;
            border: 1px solid #ff5a34;
        }

        .wg-cap-btn .wg-cap-state__over {
            color: #ffa000;
            background: #fdf6ec;
            border: 1px solid #ffbe09;
        }

        .wg-cap-btn .wg-cap-state__success {
            color: #5eaa2f;
            background: #f0f9eb;
            border: 1px solid #8bc640;
            pointer-events: none;
        }

        .wg-cap-btn .wg-cap-active__default .wg-cap-state__default, .wg-cap-btn .wg-cap-active__error .wg-cap-state__error, .wg-cap-btn .wg-cap-active__over .wg-cap-state__over, .wg-cap-btn .wg-cap-active__success .wg-cap-state__success {
            visibility: visible;
        }

        .wg-cap-btn .wg-cap-state__inner {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
            justify-content: center;
            justify-items: center;
        }

        .wg-cap-btn .wg-cap-state__inner em {
            padding-left: 5px;
            color: #3e7cff;
            font-style: normal;
        }

        .wg-cap-btn .wg-cap-btn__inner .wg-cap-btn__ico {
            position: relative;
            width: 24px;
            height: 24px;
            margin-right: 12px;
            font-size: 14px;
            display: inline-block;
            float: left;
            flex: 0;
        }

        .wg-cap-btn .wg-cap-btn__inner .wg-cap-btn__ico img {
            width: 24px;
            height: 24px;
            float: left;
            position: relative;
            z-index: 10;
        }

        @keyframes ripple {
            0% {
                opacity: 0;
            }
            5% {
                opacity: 0.05;
            }
            20% {
                opacity: 0.35;
            }
            65% {
                opacity: 0.01;
            }
            100% {
                transform: scaleX(2) scaleY(2);
                opacity: 0;
            }
        }

        @-webkit-keyframes ripple {
            0% {
                opacity: 0;
            }
            5% {
                opacity: 0.05;
            }
            20% {
                opacity: 0.35;
            }
            65% {
                opacity: 0.01;
            }
            100% {
                transform: scaleX(2) scaleY(2);
                opacity: 0;
            }
        }

        .wg-cap-btn .wg-cap-btn__inner .wg-cap-btn__verify::after {
            background: #409eff;
            -webkit-border-radius: 50px;
            -moz-border-radius: 50px;
            border-radius: 50px;
            content: "";
            display: block;
            width: 24px;
            height: 24px;
            opacity: 0;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 9;

            animation: ripple 1.3s infinite;
            -moz-animation: ripple 1.3s infinite;
            -webkit-animation: ripple 1.3s infinite;
            animation-delay: 2s;
            -moz-animation-delay: 2s;
            -webkit-animation-delay: 2s;
        }

        .wg-cap-tip {
            padding: 50px 20px 100px;
            font-size: 13px;
            color: #76839b;
            text-align: center;
            line-height: 180%;
            width: 100%;
            /*max-width: 680px;*/
        }

        .wg-cap-tip a {
            display: inline-block;
            margin: 0 5px;
        }

        .wg-cap-tip a img {
            height: 28px;
        }

        .wg-capt-other-btns {
            text-align: center;
            padding: 30px 10px 0;
        }

        .wg-capt-other-btns a {
            color: #4e87ff;
            text-decoration: none;
            padding: 6px 2px;
            margin: 2px 5px;
            display: inline-block;
            font-size: 14px;
        }

        .wg-capt-other-btns a.active {
            color: #4e87ff !important;
            pointer-events: none;
            border-bottom: 2px solid #3e7cff;
        }

        .wg-capt-other-btns a:hover {
            color: #6a99fb;
            text-decoration: none;
        }

    </style>
    <!-- 加载 common.js 脚本 -->
    <script>

        var Helper = (function () {
            function addEventListener(el, type, fn, c) {
                if (el.addEventListener) {
                    el.addEventListener(type, fn, c);
                } else {
                    el["on" + type] = fn;
                }
            }

            function removeEventListener(el, type, fn, c) {
                if (el.removeEventListener) {
                    el.removeEventListener(type, fn, c);
                } else {
                    el["on" + type] = null;
                }
            }

            function calcLocationLeft(el) {
                var tmp = el.offsetLeft
                var val = el.offsetParent
                while (val != null) {
                    tmp += val.offsetLeft
                    val = val.offsetParent
                }
                return tmp
            }

            function calcLocationTop(el) {
                var tmp = el.offsetTop
                var val = el.offsetParent
                while (val != null) {
                    tmp += val.offsetTop
                    val = val.offsetParent
                }
                return tmp
            }

            function getDomXY(dom) {
                var x = 0
                var y = 0
                if (dom.getBoundingClientRect) {
                    var box = dom.getBoundingClientRect();
                    var D = document.documentElement;
                    x = box.left + Math.max(D.scrollLeft, document.body.scrollLeft) - D.clientLeft;
                    y = box.top + Math.max(D.scrollTop, document.body.scrollTop) - D.clientTop
                } else {
                    while (dom !== document.body) {
                        x += dom.offsetLeft
                        y += dom.offsetTop
                        dom = dom.offsetParent
                    }
                }
                return {
                    domX: x,
                    domY: y
                }
            }

            var checkTargetFather = function (that, e) {
                var parent = e.relatedTarget
                try {
                    while (parent && parent !== that) {
                        parent = parent.parentNode
                    }
                } catch (e) {
                    console.warn(e)
                }
                return parent !== that
            }

            return {
                addEventListener: addEventListener,
                removeEventListener: removeEventListener,
                getDomXY: getDomXY,
                calcLocationTop: calcLocationTop,
                calcLocationLeft: calcLocationLeft,
                checkTargetFather: checkTargetFather,
            }
        })();

    </script>

</head>

<!--
说明：本实例使用纯原生编写，不使用 webpack 等web构建工具
已提供 react vue 等实例
-->
<body>
<div class="wg-cap-root">
    <div id="wg-cap-container" class="wg-cap-container">
        <div class="wg-cap-block">
            <!-- wrap -->
            <div id="wg-cap-wrap" class="wg-cap-wrap">
                <div class="wg-cap-wrap__header">
                    <span>请在下图<em>依次</em>点击：</span>
                    <img id="wg-cap-thumb" class="wg-cap-wrap__thumb" src="" alt="...">
                </div>
                <div class="wg-cap-wrap__body click_body">
                    <img id="wg-cap-image" class="wg-cap-wrap__picture" src="" alt="...">
                    <img class="wg-cap-wrap__loading"
                         src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBzdHlsZT0ibWFyZ2luOiBhdXRvOyBiYWNrZ3JvdW5kOiByZ2JhKDI0MSwgMjQyLCAyNDMsIDApOyBkaXNwbGF5OiBibG9jazsgc2hhcGUtcmVuZGVyaW5nOiBhdXRvOyIgd2lkdGg9IjY0cHgiIGhlaWdodD0iNjRweCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIj4KICA8Y2lyY2xlIGN4PSI1MCIgY3k9IjM2LjgxMDEiIHI9IjEzIiBmaWxsPSIjM2U3Y2ZmIj4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9ImN5IiBkdXI9IjFzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgY2FsY01vZGU9InNwbGluZSIga2V5U3BsaW5lcz0iMC40NSAwIDAuOSAwLjU1OzAgMC40NSAwLjU1IDAuOSIga2V5VGltZXM9IjA7MC41OzEiIHZhbHVlcz0iMjM7Nzc7MjMiPjwvYW5pbWF0ZT4KICA8L2NpcmNsZT4KPC9zdmc+"
                         alt="正在加载中...">
                    <div id="wg-cap-dots">
                        <!-- <div class="wg-cap-wrap__dot"><span>1</span></div> -->
                    </div>
                </div>
                <div class="wg-cap-wrap__footer">
                    <div class="wg-cap-wrap__ico">
                        <img id="wg-cap-close-btn"
                             src="data:image/svg+xml;base64,PHN2ZyB0PSIxNjI2NjE0NDM5NDIzIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9Ijg2NzUiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48cGF0aCBkPSJNNTEyIDIzLjI3MjcyN2MyNjkuOTE3MDkxIDAgNDg4LjcyNzI3MyAyMTguODEwMTgyIDQ4OC43MjcyNzMgNDg4LjcyNzI3M2E0ODYuNjMyNzI3IDQ4Ni42MzI3MjcgMCAwIDEtODQuOTQ1NDU1IDI3NS40MDk0NTUgNDYuNTQ1NDU1IDQ2LjU0NTQ1NSAwIDAgMS03Ni44NDY1NDUtNTIuNTI2NTQ2QTM5My41NDE4MTggMzkzLjU0MTgxOCAwIDAgMCA5MDcuNjM2MzY0IDUxMmMwLTIxOC41MDc2MzYtMTc3LjEyODcyNy0zOTUuNjM2MzY0LTM5NS42MzYzNjQtMzk1LjYzNjM2NFMxMTYuMzYzNjM2IDI5My40OTIzNjQgMTE2LjM2MzYzNiA1MTJzMTc3LjEyODcyNyAzOTUuNjM2MzY0IDM5NS42MzYzNjQgMzk1LjYzNjM2NGEzOTUuMTcwOTA5IDM5NS4xNzA5MDkgMCAwIDAgMTI1LjQ0LTIwLjI5MzgxOSA0Ni41NDU0NTUgNDYuNTQ1NDU1IDAgMCAxIDI5LjQ4NjU0NSA4OC4yOTY3MjhBNDg4LjI2MTgxOCA0ODguMjYxODE4IDAgMCAxIDUxMiAxMDAwLjcyNzI3M0MyNDIuMDgyOTA5IDEwMDAuNzI3MjczIDIzLjI3MjcyNyA3ODEuOTE3MDkxIDIzLjI3MjcyNyA1MTJTMjQyLjA4MjkwOSAyMy4yNzI3MjcgNTEyIDIzLjI3MjcyN3ogbS0xMTUuMiAzMDcuNzEyTDUxMiA0NDYuMTM4MTgybDExNS4yLTExNS4yYTQ2LjU0NTQ1NSA0Ni41NDU0NTUgMCAxIDEgNjUuODE1MjczIDY1Ljg2MTgxOEw1NzcuODYxODE4IDUxMmwxMTUuMiAxMTUuMmE0Ni41NDU0NTUgNDYuNTQ1NDU1IDAgMSAxLTY1Ljg2MTgxOCA2NS44MTUyNzNMNTEyIDU3Ny44NjE4MThsLTExNS4yIDExNS4yYTQ2LjU0NTQ1NSA0Ni41NDU0NTUgMCAxIDEtNjUuODE1MjczLTY1Ljg2MTgxOEw0NDYuMTM4MTgyIDUxMmwtMTE1LjItMTE1LjJhNDYuNTQ1NDU1IDQ2LjU0NTQ1NSAwIDEgMSA2NS44NjE4MTgtNjUuODE1MjczeiIgcC1pZD0iODY3NiIgZmlsbD0iIzcwNzA3MCI+PC9wYXRoPjwvc3ZnPg=="
                             alt="关闭">
                        <img id="wg-cap-refresh-btn"
                             src="data:image/svg+xml;base64,PHN2ZyB0PSIxNjI2NjE0NDk5NjM4IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEzNjAiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48cGF0aCBkPSJNMTg3LjQ1NiA0MjUuMDI0YTMzNiAzMzYgMCAwIDAgMzY4LjM4NCA0MjAuMjI0IDQ4IDQ4IDAgMCAxIDEyLjU0NCA5NS4xNjggNDMyIDQzMiAwIDAgMS00NzMuNjY0LTU0MC4xNmwtNTcuMjgtMTUuMzZhMTIuOCAxMi44IDAgMCAxLTYuMjcyLTIwLjkyOGwxNTkuMTY4LTE3OS40NTZhMTIuOCAxMi44IDAgMCAxIDIyLjE0NCA1Ljg4OGw0OC4wNjQgMjM1LjA3MmExMi44IDEyLjggMCAwIDEtMTUuODA4IDE0LjkxMmwtNTcuMjgtMTUuMzZ6TTgzNi40OCA1OTkuMDRhMzM2IDMzNiAwIDAgMC0zNjguMzg0LTQyMC4yMjQgNDggNDggMCAxIDEtMTIuNTQ0LTk1LjE2OCA0MzIgNDMyIDAgMCAxIDQ3My42NjQgNTQwLjE2bDU3LjI4IDE1LjM2YTEyLjggMTIuOCAwIDAgMSA2LjI3MiAyMC45MjhsLTE1OS4xNjggMTc5LjQ1NmExMi44IDEyLjggMCAwIDEtMjIuMTQ0LTUuODg4bC00OC4wNjQtMjM1LjA3MmExMi44IDEyLjggMCAwIDEgMTUuODA4LTE0LjkxMmw1Ny4yOCAxNS4zNnoiIGZpbGw9IiM3MDcwNzAiIHAtaWQ9IjEzNjEiPjwvcGF0aD48L3N2Zz4="
                             alt="刷新">
                    </div>
                    <div class="wg-cap-wrap__btn">
                        <button id="wg-cap-check-btn">确认</button>
                    </div>
                </div>
            </div>
            <!-- dialog -->
            <div id="wg-cap-dialog" class="wg-cap-dialog"></div>
            <!-- button -->
            <div class="wg-cap-btn">
                <!-- wg-cap-active__default wg-cap-active__error wg-cap-active__over wg-cap-active__success--->
                <div id="wg-cap-btn-control" class="wg-cap-btn__inner wg-cap-active__default">
                    <div id="wg-cap-btn-default" class="wg-cap-state__default">
                        <!-- 初始状态 -->
                        <div class="wg-cap-state__inner">
                            <div class="wg-cap-btn__ico wg-cap-btn__verify">
                                <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSLlm77lsYJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDIwMCAyMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDIwMCAyMDA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojM0U3Q0ZGO30KCS5zdDF7ZmlsbDojRkZGRkZGO30KPC9zdHlsZT4KPGNpcmNsZSBjbGFzcz0ic3QwIiBjeD0iMTAwIiBjeT0iMTAwIiByPSI5Ni4zIi8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0xNDAuOCw2NC40bC0zOS42LTExLjloLTIuNEw1OS4yLDY0LjRjLTEuNiwwLjgtMi44LDIuNC0yLjgsNHYyNC4xYzAsMjUuMywxNS44LDQ1LjksNDIuMyw1NC42CgljMC40LDAsMC44LDAuNCwxLjIsMC40YzAuNCwwLDAuOCwwLDEuMi0wLjRjMjYuNS04LjcsNDIuMy0yOC45LDQyLjMtNTQuNlY2OC4zQzE0My41LDY2LjgsMTQyLjMsNjUuMiwxNDAuOCw2NC40eiIvPgo8L3N2Zz4K">
                            </div>
                            <span class="wg-cap-btn__text">点击按键进行验证</span>
                        </div>
                    </div>
                    <div id="wg-cap-btn-error" class="wg-cap-state__error">
                        <!-- 验证失败状态 -->
                        <div class="wg-cap-state__inner">
                            <div class="wg-cap-btn__ico">
                                <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAyMDAgMjAwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyMDAgMjAwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe2ZpbGw6I0VENDYzMDt9Cjwvc3R5bGU+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xODQsMjYuNkwxMDIuNCwyLjFoLTQuOUwxNiwyNi42Yy0zLjMsMS42LTUuNyw0LjktNS43LDguMnY0OS44YzAsNTIuMiwzMi42LDk0LjcsODcuMywxMTIuNgoJYzAuOCwwLDEuNiwwLjgsMi40LDAuOHMxLjYsMCwyLjQtMC44YzU0LjctMTgsODcuMy01OS42LDg3LjMtMTEyLjZWMzQuN0MxODkuOCwzMS41LDE4Ny4zLDI4LjIsMTg0LDI2LjZ6IE0xMzQuNSwxMjMuMQoJYzMuMSwzLjEsMy4xLDguMiwwLDExLjNjLTEuNiwxLjYtMy42LDIuMy01LjcsMi4zcy00LjEtMC44LTUuNy0yLjNMMTAwLDExMS4zbC0yMy4xLDIzLjFjLTEuNiwxLjYtMy42LDIuMy01LjcsMi4zCgljLTIsMC00LjEtMC44LTUuNy0yLjNjLTMuMS0zLjEtMy4xLTguMiwwLTExLjNMODguNywxMDBMNjUuNSw3Ni45Yy0zLjEtMy4xLTMuMS04LjIsMC0xMS4zYzMuMS0zLjEsOC4yLTMuMSwxMS4zLDBMMTAwLDg4LjcKCWwyMy4xLTIzLjFjMy4xLTMuMSw4LjItMy4xLDExLjMsMGMzLjEsMy4xLDMuMSw4LjIsMCwxMS4zTDExMS4zLDEwMEwxMzQuNSwxMjMuMXoiLz4KPC9zdmc+Cg=="
                                     alt="失败">
                            </div>
                            <span>验证失败 <em>点击重试</em></span>
                        </div>
                    </div>
                    <div id="wg-cap-btn-over" class="wg-cap-state__over">
                        <!-- 验证次数过多状态 -->
                        <div class="wg-cap-state__inner">
                            <div class="wg-cap-btn__ico">
                                <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAyMDAgMjAwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyMDAgMjAwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe2ZpbGw6I0VENDYzMDt9Cjwvc3R5bGU+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xODQsMjYuNkwxMDIuNCwyLjFoLTQuOUwxNiwyNi42Yy0zLjMsMS42LTUuNyw0LjktNS43LDguMnY0OS44YzAsNTIuMiwzMi42LDk0LjcsODcuMywxMTIuNgoJYzAuOCwwLDEuNiwwLjgsMi40LDAuOHMxLjYsMCwyLjQtMC44YzU0LjctMTgsODcuMy01OS42LDg3LjMtMTEyLjZWMzQuN0MxODkuOCwzMS41LDE4Ny4zLDI4LjIsMTg0LDI2LjZ6IE0xMzQuNSwxMjMuMQoJYzMuMSwzLjEsMy4xLDguMiwwLDExLjNjLTEuNiwxLjYtMy42LDIuMy01LjcsMi4zcy00LjEtMC44LTUuNy0yLjNMMTAwLDExMS4zbC0yMy4xLDIzLjFjLTEuNiwxLjYtMy42LDIuMy01LjcsMi4zCgljLTIsMC00LjEtMC44LTUuNy0yLjNjLTMuMS0zLjEtMy4xLTguMiwwLTExLjNMODguNywxMDBMNjUuNSw3Ni45Yy0zLjEtMy4xLTMuMS04LjIsMC0xMS4zYzMuMS0zLjEsOC4yLTMuMSwxMS4zLDBMMTAwLDg4LjcKCWwyMy4xLTIzLjFjMy4xLTMuMSw4LjItMy4xLDExLjMsMGMzLjEsMy4xLDMuMSw4LjIsMCwxMS4zTDExMS4zLDEwMEwxMzQuNSwxMjMuMXoiLz4KPC9zdmc+Cg=="
                                     alt="失败">
                            </div>
                            <span>点击次数过多 <em>点击重试</em></span>
                        </div>
                    </div>
                    <div class="wg-cap-state__success">
                        <!-- 验证成功状态 -->
                        <div class="wg-cap-state__inner">
                            <div class="wg-cap-btn__ico">
                                <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAyMDAgMjAwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyMDAgMjAwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe2ZpbGw6IzVFQUEyRjt9Cjwvc3R5bGU+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xODMuMywyNy4yTDEwMi40LDIuOWgtNC45TDE2LjcsMjcuMkMxMy40LDI4LjgsMTEsMzIsMTEsMzUuM3Y0OS40YzAsNTEuOCwzMi40LDkzLjksODYuNiwxMTEuNwoJYzAuOCwwLDEuNiwwLjgsMi40LDAuOGMwLjgsMCwxLjYsMCwyLjQtMC44YzU0LjItMTcuOCw4Ni42LTU5LjEsODYuNi0xMTEuN1YzNS4zQzE4OSwzMiwxODYuNiwyOC44LDE4My4zLDI3LjJ6IE0xNDYuMSw4MS40CglsLTQ4LjUsNDguNWMtMS42LDEuNi0zLjIsMi40LTUuNywyLjRjLTIuNCwwLTQtMC44LTUuNy0yLjRMNjIsMTA1LjdjLTMuMi0zLjItMy4yLTguMSwwLTExLjNjMy4yLTMuMiw4LjEtMy4yLDExLjMsMGwxOC42LDE4LjYKCWw0Mi45LTQyLjljMy4yLTMuMiw4LjEtMy4yLDExLjMsMEMxNDkuNCw3My4zLDE0OS40LDc4LjIsMTQ2LjEsODEuNEwxNDYuMSw4MS40eiIvPgo8L3N2Zz4K"
                                     alt="成功">
                            </div>
                            <span>已验证成功</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

    var Captcha = (function () {

        var captchaKey = ""
        var maxDot = 8
        var dots = []

        var hiddenClassName = "wg-cap-wrap__hidden"
        var dialogActiveClassName = "wg-cap-dialog__active"
        var activeDefaultClassName = "wg-cap-active__default"
        var activeOverClassName = "wg-cap-active__over"
        var activeErrorClassName = "wg-cap-active__error"
        var activeSuccessClassName = "wg-cap-active__success"

        var captchaWrapDom = document.querySelector("#wg-cap-dots")
        var captchaImageDom = document.querySelector("#wg-cap-image")
        var captchaThumbDom = document.querySelector("#wg-cap-thumb")
        var captchaBtnControlDom = document.querySelector("#wg-cap-btn-control")
        var captchaCheckBtnDom = document.querySelector("#wg-cap-check-btn")
        var captchaCloseBtnDom = document.querySelector("#wg-cap-close-btn")
        var captchaDialogBtnDom = document.querySelector("#wg-cap-dialog")
        var captchaRefreshBtnDom = document.querySelector("#wg-cap-refresh-btn")
        var captchaDefaultBtnDom = document.querySelector("#wg-cap-btn-default")
        var captchaErrorBtnDom = document.querySelector("#wg-cap-btn-error")
        var captchaOverBtnDom = document.querySelector("#wg-cap-btn-over")
        var dialogDom = document.querySelector("#wg-cap-container")

        function __initialize() {
            // requestCaptchaData()
            handleEvent()

            document.addEventListener('touchstart', (event) => {
                if (event.touches.length > 1) {
                    event.preventDefault()
                }
            })
            document.addEventListener('gesturestart', (event) => {
                event.preventDefault()
            })
            document.body.addEventListener('touchend', () => {
            })
        }

        function handleEvent() {
            Helper.addEventListener(captchaImageDom, "click", handleClickPos, false)
            Helper.addEventListener(captchaCheckBtnDom, "click", handleClickCheck, false)
            Helper.addEventListener(captchaCloseBtnDom, "click", handleClickClose, false)
            Helper.addEventListener(captchaDialogBtnDom, "click", handleClickClose, false)
            Helper.addEventListener(captchaRefreshBtnDom, "click", handleClickRefresh, false)
            Helper.addEventListener(captchaDefaultBtnDom, "click", handleClickDefault, false)
            Helper.addEventListener(captchaErrorBtnDom, "click", handleClickDefault, false)
            Helper.addEventListener(captchaOverBtnDom, "click", handleClickDefault, false)
        }

        function appendDotIcon(event, x, y) {
            var dot = document.createElement('div')
            dot.setAttribute('class', 'wg-cap-wrap__dot')
            dot.setAttribute('style', 'top:' + (y - 11) + 'px; left:' + (x - 11) + 'px;')
            dot.innerHTML = '<span>' + (dots.length + 1) + '</span>'
            captchaWrapDom.appendChild(dot)
            dots.push([x, y])
        }

        function resetCaptcha() {
            captchaKey = ""
            dots = []
            captchaWrapDom.innerHTML = ""
        }

        function clearImage() {
            captchaImageDom.setAttribute("src", "")
            captchaThumbDom.setAttribute("src", "")
        }

        function handleClickPos(ev) {
            if (dots.length >= maxDot || captchaKey === "") {
                return
            }

            var e = ev || window.event;
            var dom = e.currentTarget

            var xy = Helper.getDomXY(dom)

            var mouseX = e.pageX || e.clientX
            var mouseY = e.pageY || e.clientY

            var domX = xy.domX
            var domY = xy.domY

            var xPos = mouseX - domX;
            var yPos = mouseY - domY;

            appendDotIcon(e, parseInt(xPos.toString()), parseInt(yPos.toString()))
            e.cancelBubble = true
            e.preventDefault()
            return false
        }

        function handleClickRefresh() {
            requestCaptchaData()
        }

        function handleClickClose() {
            dialogDom.classList.remove(dialogActiveClassName)
        }

        function handleClickCheck() {
            var dotsA = []
            dots.forEach(function (value, key) {
                dotsA.push(value.join(","))
            })

            if (dotsA.length <= 0) {
                alert("请点选图案进行验证")
                return
            }

            requestCheckCaptchaData(JSON.stringify({'dots': dotsA.join(','), 'key': captchaKey}))
        }

        function isJSONString(str) {
            if (typeof str == 'string') {
                try {
                    var obj = JSON.parse(str)
                    return typeof obj == 'object' && obj
                } catch (e) {
                }
            }

            return false
        }

        function handleClickDefault() {
            requestCaptchaData()
            dialogDom.classList.add(dialogActiveClassName)
        }

        function requestCaptchaData(data) {
            resetCaptcha()
            clearImage()
            captchaImageDom.classList.add(hiddenClassName)
            captchaThumbDom.classList.add(hiddenClassName)

            window.getCaptchaDataApi().then(result => {

                if (!isJSONString(result.data)) {
                    console.log("请求验证码数据失败：" + result.data);
                } else {
                    var parse = JSON.parse(result.data)
                    if (parse['code'] === 0) {
                        captchaImageDom.classList.remove(hiddenClassName)
                        captchaThumbDom.classList.remove(hiddenClassName)
                        captchaImageDom.setAttribute("src", parse['image_base64'])
                        captchaThumbDom.setAttribute("src", parse['thumb_base64'])
                        captchaKey = parse['captcha_key']
                    } else {
                        alert("请求验证码数据失败：" + parse['message'])
                    }
                }
            })
        }

        function requestCheckCaptchaData(dots) {

            window.checkCaptchaDataApi(dots).then(result => {
                if (!isJSONString(result.data)) {
                    captchaBtnControlDom.classList.remove(activeDefaultClassName)
                    captchaBtnControlDom.classList.remove(activeOverClassName)
                    captchaBtnControlDom.classList.remove(activeSuccessClassName)
                    captchaBtnControlDom.classList.add(activeErrorClassName)
                    requestCaptchaData()
                } else {
                    captchaBtnControlDom.classList.remove(activeDefaultClassName)
                    captchaBtnControlDom.classList.remove(activeOverClassName)
                    var data = JSON.parse(result.data)

                    if (data['code'] === 0) {
                        alert("验证成功")
                        captchaBtnControlDom.classList.remove(activeErrorClassName)
                        captchaBtnControlDom.classList.add(activeSuccessClassName)
                        setTimeout(function () {
                            handleClickClose()
                        }, 200)
                    } else {
                        alert("验证失败")
                        captchaBtnControlDom.classList.remove(activeSuccessClassName)
                        captchaBtnControlDom.classList.add(activeErrorClassName)
                        requestCaptchaData()
                    }
                }
                captchaKey = ""
            })
        }

        __initialize()
        return {}
    });

    window.addEventListener("DOMContentLoaded", Captcha())

</script>
</body>
</html>
